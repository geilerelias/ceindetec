import{A as n}from"./AppLayout.0f21bcf8.js";import{B as o}from"./BreadCrumbs.14245490.js";import{n as l}from"./_plugin-vue2_normalizer.358ffe07.js";import"./Footer.8980123f.js";import"./app.8c123d0c.js";import"./logo-ceindetec.0997e866.js";import"./Logo.5a18e3f9.js";import"./SettingsDropdown.af9b0a02.js";const c={components:{AppLayout:n,BreadCrumbs:o},props:["data","errors"],data(){return{saving:!1,valid:!1,menu1:!1,menu2:!1,establishments:[],editMode:!1,isOpen:!1,search:"",rules:{required:a=>!!a||"Campo requerido.",max:a=>a.length<=20||"M\xE1ximo 20 caracteres",min:a=>a.length>=10||"M\xEDnimo 10 caracteres",email:a=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)||"Invalid e-mail.",phone:a=>/^\(?(\d{3})\)?[- ]?(\d{3})[- ]?(\d{4})$/.test(a)||"Numero telef\xF3nico invalido.",text:a=>/^\s+$/.test(a)||"Solo caracteres alfab\xE9ticos.",number:a=>/^\d+$/.test(a)||"solo caracteres num\xE9ricos."},form:{name:null,establishments_id:null,starts_at:null,ends_at:null},headers:[{text:"Id",align:"start",sortable:!1,value:"id"},{text:"Nombre",value:"name"},{text:"Establecimiento",value:"establishments_id"},{text:"Inicia",value:"starts_at"},{text:"Finaliza",value:"ends_at"},{text:"Acciones",value:"actions",sortable:!1}],editedIndex:-1,editedItem:{name:null,establishments_id:null,starts_at:null,ends_at:null},defaultItem:{name:null,establishments_id:null,starts_at:null,ends_at:null},items:[{text:"Dashboard",disabled:!1,href:"dashboard"},{text:"A\xF1o lectivos",disabled:!0,href:"year.index"}]}},created(){axios.get("/dashboard/establishment/all").then(a=>{this.establishments=a.data})},methods:{validate(){this.$refs.form.validate()},getActualYear(){return new Date(Date.parse(`${new Date().getFullYear().toString()}-01-01`)).toISOString().slice(0,7)},openModal:function(){this.isOpen=!0},closeModal:function(){this.isOpen=!1,this.reset(),this.editMode=!1},reset:function(){this.form=this.defaultItem},resetValidation(){this.$refs.form.resetValidation()},save:function(a){this.saving=!0,!this.validate()&&!this.valid?(this.$swal.fire("Campos Obligatorio!","Ingresa los campos obligatorios!","error"),this.saving=!1):this.$inertia.post(this.route("year.store"),a,{onSuccess:e=>{e.data,console.log(e),this.$swal({icon:`${this.$page.errors.name?"error":"success"}`,title:`${this.$page.errors.name?"Ups...":"\xA1Buen trabajo!"}`,text:`${this.$page.errors.name?this.$page.errors.name[0]:this.$page.flash.message}`}).then(t=>{this.saving=!1,t.isConfirmed&&(this.headquarters=this.defaultHeadquarters,this.reset(),this.resetValidation(),this.$inertia.get(this.route("year.index")))})},onError:e=>{this.saving=!1;const t=e.response.data.errors;let s="";for(var r in t)s+=r+": "+t[r]+`
 `;this.$swal.fire("Error!",s,"error"),console.log(s)},onFinish:e=>{this.saving=!1}})},edit:function(a){this.form=Object.assign({},a),this.editMode=!0,this.openModal()},update:function(a){a._method="PUT",this.$inertia.post(this.route("year.update",a.id),a,{onSuccess:e=>{this.$swal({icon:`${e.props.errors.message?"error":"success"}`,title:`${e.props.errors.message?"Ups...":"\xA1Buen trabajo!"}`,text:`${e.props.errors.message?e.props.errors.message:e.props.flash.message}`}),this.reset(),this.closeModal()},onError:e=>{this.reset(),this.closeModal()},onFinish:e=>{this.reset(),this.closeModal()}})},deleteRow(a){a._method="DELETE",this.$swal({title:"\xBFEst\xE1 seguro de que desea eliminar este elemento?",text:"\xA1No podr\xE1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, Eliminarlo!"}).then(e=>{e.isConfirmed&&this.$inertia.post(this.route("year.destroy",a.id),a,{onStart:t=>{this.loadingDeleteItem=!0},onSuccess:t=>{console.log("estamos eliminando la info",t),this.$swal({icon:`${t.props.errors.message?"error":"success"}`,title:`${t.props.errors.message?"Ups...":"\xA1Buen trabajo!"}`,text:`${t.props.errors.message?t.props.errors.message:t.props.flash.message}`})},onError:t=>{this.$swal("\xA1Ay...!","Disculpe, ocurri\xF3 un error.","warning")},onFinish:t=>{this.loadingDeleteItem=!1}})})},initialize(){this.$inertia.get(this.route("year.index"))}}};var d=function(){var e=this,t=e._self._c;return t("app-layout",[t("bread-crumbs",{attrs:{name:"A\xF1o Acad\xE9mico",items:e.items}}),t("v-container",{staticClass:"py-12"},[t("v-row",{staticClass:"ma-0"},[t("v-col",[t("v-card",{staticStyle:{width:"100%"}},[t("v-card-text",{},[t("v-row",{staticClass:"no-gutters"},[t("div",{staticClass:"d-flex justify-space-between justify-md-start col-md-6 col-12"},[t("v-btn",{staticClass:"mr-3 success",on:{click:function(s){e.isOpen=!e.isOpen}}},[t("v-icon",{staticClass:"notranslate mr-2"},[e._v(" mdi-plus ")]),e._v(" Add ")],1),t("v-btn",{staticClass:"button-shadow primary--text",attrs:{outlined:""}},[t("v-icon",{staticClass:"notranslate mr-2",attrs:{"aria-hidden":"true"}},[e._v(" mdi-filter-variant ")]),e._v(" Filters ")],1)],1),t("v-spacer"),t("div",{staticClass:"mx-auto mt-4 mt-md-0",staticStyle:{"max-width":"250px"}},[t("v-text-field",{attrs:{"hide-details":"",dense:"",enclosed:"",outlined:"","append-icon":"mdi-magnify",placeholder:"search"},model:{value:e.search,callback:function(s){e.search=s},expression:"search"}})],1)],1)],1)],1)],1)],1),t("v-row",{staticClass:"ma-0"},[t("v-col",[t("v-card",{staticStyle:{width:"100%"}},[t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.data,"sort-by":"calories",search:e.search},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(r){return e.edit(s)}}},[e._v(" mdi-pencil-outline ")]),t("v-icon",{attrs:{small:""},on:{click:function(r){return e.deleteRow(s)}}},[e._v(" mdi-delete-outline ")])]}},{key:"no-data",fn:function(){return[t("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}])})],1)],1)],1)],1),t("v-dialog",{attrs:{"max-width":"800"},model:{value:e.isOpen,callback:function(s){e.isOpen=s},expression:"isOpen"}},[t("v-form",{ref:"form",model:{value:e.valid,callback:function(s){e.valid=s},expression:"valid"}},[t("v-card",{staticClass:"pa-6"},[t("v-card-text",[t("v-row",[t("v-col",{staticClass:"col-12"},[t("v-text-field",{attrs:{counter:10,label:"Nombre",rules:[e.rules.required]},model:{value:e.form.name,callback:function(s){e.$set(e.form,"name",s)},expression:"form.name"}}),e.$page.errors.title?t("div",{staticClass:"text-red-500"},[e._v(e._s(e.$page.errors.title[0])+" ")]):e._e()],1),t("v-col",{staticClass:"col-12"},[t("v-select",{attrs:{items:e.establishments,"item-text":"name","item-value":"id",label:"Establecimiento al que pertenece",rules:[e.rules.required]},model:{value:e.form.establishments_id,callback:function(s){e.$set(e.form,"establishments_id",s)},expression:"form.establishments_id"}}),e.$page.errors.starts_at?t("div",{staticClass:"text-red-500"},[e._v(e._s(e.$page.errors.starts_at[0])+" ")]):e._e()],1)],1),t("v-row",[t("v-col",[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:r}){return[t("v-text-field",e._g(e._b({attrs:{label:"fecha de inicializaci\xF3n",readonly:"",rules:[e.rules.required]},model:{value:e.form.starts_at,callback:function(i){e.$set(e.form,"starts_at",i)},expression:"form.starts_at"}},"v-text-field",r,!1),s))]}}]),model:{value:e.menu1,callback:function(s){e.menu1=s},expression:"menu1"}},[t("v-date-picker",{attrs:{min:e.getActualYear(),locale:"es-Es"},on:{input:function(s){e.menu1=!1}},model:{value:e.form.starts_at,callback:function(s){e.$set(e.form,"starts_at",s)},expression:"form.starts_at"}})],1),e.$page.errors.starts_at?t("div",{staticClass:"text-red-500"},[e._v(e._s(e.$page.errors.starts_at[0])+" ")]):e._e()],1),t("v-col",[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:r}){return[t("v-text-field",e._g(e._b({attrs:{label:"fecha de finalizaci\xF3n",readonly:"",rules:[e.rules.required]},model:{value:e.form.ends_at,callback:function(i){e.$set(e.form,"ends_at",i)},expression:"form.ends_at"}},"v-text-field",r,!1),s))]}}]),model:{value:e.menu2,callback:function(s){e.menu2=s},expression:"menu2"}},[t("v-date-picker",{attrs:{disabled:e.form.starts_at==null,min:e.form.starts_at,locale:"es-Es"},on:{input:function(s){e.menu2=!1}},model:{value:e.form.ends_at,callback:function(s){e.$set(e.form,"ends_at",s)},expression:"form.ends_at"}})],1),e.$page.errors.ends_at?t("div",{staticClass:"text-red-500"},[e._v(e._s(e.$page.errors.ends_at[0])+" ")]):e._e()],1)],1),t("div",{staticClass:"d-flex justify-end"},[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.editMode,expression:"!editMode"}],staticClass:"primary mx-1",attrs:{"wire:click.prevent":"store()",type:"button",dark:""},on:{click:function(s){return e.save(e.form)}}},[e._v(" Save ")]),t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],staticClass:"primary x-1",attrs:{"wire:click.prevent":"store()",type:"button",dark:""},on:{click:function(s){return e.update(e.form)}}},[e._v(" Update ")]),t("v-btn",{staticClass:"secondary mx-1",attrs:{type:"button",dark:""},on:{click:function(s){return e.closeModal()}}},[e._v(" Cancel ")])],1)],1)],1)],1)],1)],1)},u=[],m=l(c,d,u,!1,null,null,null,null);const g=m.exports;export{g as default};
